% this script interacts with simulation data for visualization/analysis

clear all;

savepath = '/Users/Keisuke/Dropbox/KorolevGroup/simudata/asobi/';

old = cd(savepath);
files = dir('*.mat');
cd(old);

fig_endpoint = figure(1);

for 

% load mat file


set(0, 'currentfigure', fig_endpoint);


load(strcat(savepath,'sim0006.mat'));





%% plot length distribution

MT = result(:,:,end);
lengths = MT(MT(:,3)~=0, 3)-MT(MT(:,3)~=0, 2);
h1 = figure(1);
set(0,'DefaultAxesFontSize', 16)
set(0, 'DefaultFigurePosition', [10 10 350 250]);
hist(lengths)

%% plot plus and minus ends

s = size(result);
[grad,im] = colorGradient([0 0.6 1],[1 0.1 0], s(3));

h2 = figure(2);
set(0,'DefaultAxesFontSize', 16)
set(0, 'DefaultFigurePosition', [10 10 350 250]);

for i = 1:s(3)
    MT = result(:,:,i);
    
    plusends   = hist(MT(any(MT,2),3),xbin);
    minusends  = hist(MT(any(MT,2),2),xbin);

    figure(2); hold on;
    plot(xbin, plusends, '.', 'Color', grad(i,:), 'MarkerSize', 14);
    
    figure(3); hold on;
    diff_polymer = minusends-plusends;
    plot(xbin, cumsum(diff_polymer),'.', 'Color', grad(i,:), 'MarkerSize', 14);
    
end